<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>game_box</title>
    <style>
        *{
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body{
    font-family:Arial, Helvetica, sans-serif;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    background-color: #edece5; 
}

.CONTAINER{
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
}

.game-board{
    display: grid;
    grid-template-columns: repeat(4, 100px);
    grid-template-rows: repeat(4, 100px);
    gap: 10px;
    padding: 10px;
    background-color: #9b8d81;
    border-radius: 10px;
}
.title{
    width: 100px;
    height: 100px;
    border-radius: 5px;
    background-color: #d7e1c1;
    font-size: 24px;
    font-weight: bold;
    display: flex;
    color: #776e55;
    justify-content: center;
    align-items: center;
}

.title-2{
    background-color: #EEEFDA;
}
.title-4{
    background-color: #f5713d;
}
.title-8{
    background-color: #d69617;
    color: white;
}
.title-16{
    background-color: #b9e230;
    color: whitesmoke;
}
.title-32{
    background-color: #0fdd13;
    color: black;
}
.title-64{
    background-color: #65e1bc;
}
.title-128{
    background-color: #11b6e3;
    color: rgb(0, 0, 0);
}
.title-256{
    background-color: #0a2be6;
    color: whitesmoke;
}
.title-512{
    background-color: #801fe1;
    color: rgb(90, 65, 4);
}
.title-1024{
    background-color: #c693ef;
    color: rgb(0, 0, 0);
}
.title-2048{
    background-color: #e60ae2;
    color: whitesmoke;
}
.game_info{
   margin-top: 20px;
   text-align: center;
}
.score_container{
    font-size: 24px;
    margin-bottom: 10px;
}

button{
    padding: 10px 20px;
    background-color: #8f7a66;
    font-size: 16px;
    border: none;
    color: white;
    border-radius: 5px;
    cursor: pointer;
}

button:hover{
    background-color: #060607;
    color: rgb(212, 255, 0);
}



    </style>
</head>
<body>
    <div class="CONTAINER">



        <div class="game-board" id="game-board">
        <div class="title">0</div>
        <div class="title">1</div>
        <div class="title">2</div>
        <div class="title">3</div>
        <div class="title">4</div>
        <div class="title">5</div>
        <div class="title">6</div>
        <div class="title">7</div>
        <div class="title">8</div>
        <div class="title">9</div>
        <div class="title">10</div>
        <div class="title">11</div>
        <div class="title">12</div>
        <div class="title">13</div>
        <div class="title">14</div>
        <div class="title">15</div>
        </div>
        <div class="game_info">
            <div class="score_container">
                <span>Score :</span>
                <span id="score">0</span>
            </div>
            <button id="restart">Restart Game</button>
        </div>

    </div>
   <script>
    const board=document.getElementById('game-board');
const scoreDisplay=document.getElementById("score")

const restartButton=document.getElementById("restart");

let score=0;
let tiles=[];

function initializeGame(){
    tiles=[];
    board.innerHTML='';
    for(let i=0;i<16;i++){
        let tile=document.createElement("div");
        tile.classList.add('title');

        tile.dataset.value=0;
        tiles.push(tile);
        board.appendChild(tile)
    }
    addRandomTile();
    addRandomTile();
    updateBoard();
}


function updateBoard() {
    tiles.forEach(tile => {
        const value = parseInt(tile.dataset.value);
        tile.textContent = value > 0 ? value : '';  // <-- fixed the casing here
        tile.className = 'title';
        if (value > 0) tile.classList.add(`title-${value}`);
    });

    scoreDisplay.textContent = score;
}


function addRandomTile() {
    const emptytiles=tiles.filter(tile=>tile.dataset.value==0);
    if(emptytiles.length==0)return;
    console.log(emptytiles);
    const randomTile=emptytiles[Math.floor(Math.random()*emptytiles.length)]
    randomTile.dataset.value=Math.random()<0.9?2:4;
    
}

function move(direction) {
    let moved = false;
    console.log(`\nMoving: ${direction}`);

    for (let i = 0; i < 4; i++) {
        let line = [];

        for (let j = 0; j < 4; j++) {
            const index = direction === "up" || direction === "down" ? i + j * 4 : j + i * 4;
            const value = parseInt(tiles[index].dataset.value);
            if (value !== 0) line.push(value);
        }

        if (direction === "right" || direction === "down") {
            line.reverse();
        }

        let margedline = mergedLine(line);

        if (direction === "right" || direction === "down") {
            margedline.reverse();
        }

        for (let j = 0; j < 4; j++) {
            const index = direction === "up" || direction === "down" ? i + j * 4 : j + i * 4;
            const newvalue = margedline[j] || 0;

            if (parseInt(tiles[index].dataset.value) !== newvalue) {
                tiles[index].dataset.value = newvalue;
                moved = true;
            }
        }
    }

    if (moved) {
        console.log("Move successful, adding new tile");
        addRandomTile();
        updateBoard();
    } else {
        console.log("No tile moved");
    }
}

  function mergedLine(line){
    //224
    for(let i=0;i<line.length-1;i++){
        if(line[i]==line[i+1]){
            line[i]*=2;
            score +=line[i];
            line.splice(i+1,1);
        }

    }
    // 44
    while(line.length<4){
     line.push(0);    
    }
    //4400
    return line;
   }


document.addEventListener("keydown",(e)=>{
    switch (e.key) {
        case "ArrowUp":
           
            move("up");
            break;
        case "ArrowDown":
            move("down");
            break;
        case "ArrowLeft":
            move("left");
            break;
        case "ArrowRight":
            move("right");
            break;
    
        default:
           console.log("wrong input! ");
    }

});



initializeGame();
restartButton.addEventListener("click",initializeGame);



   </script>
</body>
</html>
